<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>DCS Reference: A simple DCSServer example</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">DCS Reference
   &#160;<span id="projectnumber">2.4</span>
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">A simple <a class="el" href="classDCSServer.html" title="A top level class for implementing a DCS data server.">DCSServer</a> example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Simple server program implemented from the <a class="el" href="classDCSServer.html" title="A top level class for implementing a DCS data server.">DCSServer</a> extension class API. The extension class makes using the DCS API much simpler, but also introduces implementation limitations that require the DCS server to work in a single-threaded/serial processing mode. This type of server may not handle multiple connections very well. A concurrent/multi-threaded server can be implemented from the raw DCS API for handling multiple simultaneous connections.</p>
<p><br/>
 </p>
<div class="fragment"><pre class="fragment"><span class="comment">/****************************************************************************</span>
<span class="comment"> *****                                                                  *****</span>
<span class="comment"> *****                   Classification: UNCLASSIFIED                   *****</span>
<span class="comment"> *****                    Classified By:                                *****</span>
<span class="comment"> *****                    Declassify On:                                *****</span>
<span class="comment"> *****                                                                  *****</span>
<span class="comment"> ****************************************************************************</span>
<span class="comment"> *</span>
<span class="comment"> *</span>
<span class="comment"> * Developed by: Naval Research Laboratory, Tactical Electronic Warfare Div.</span>
<span class="comment"> *               EW Modeling &amp; Simulation, Code 5770</span>
<span class="comment"> *               4555 Overlook Ave.</span>
<span class="comment"> *               Washington, D.C. 20375-5339</span>
<span class="comment"> *</span>
<span class="comment"> * For more information please send email to simdis@enews.nrl.navy.mil</span>
<span class="comment"> *</span>
<span class="comment"> * 2002 - U.S. Naval Research Laboratory.</span>
<span class="comment"> *</span>
<span class="comment"> * The U.S. Government retains all rights to use, duplicate, distribute,</span>
<span class="comment"> * disclose, or release this software.</span>
<span class="comment"> *</span>
<span class="comment"> */</span>

<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// scserver - a simple server program implemented from the DCSServer extension </span>
<span class="comment">//            class API.  The extension class makes using the DCS API much </span>
<span class="comment">//            simpler, but also introduces implementation limitations that</span>
<span class="comment">//            require the DCS server to work in a single-threaded/serial </span>
<span class="comment">//            processing mode.  This type of server may not handle multiple </span>
<span class="comment">//            connections very well.  A concurrent/multi-threaded server can </span>
<span class="comment">//            be implemented from the raw DCS API for handling multiple </span>
<span class="comment">//            simultaneous connections.  </span>

<span class="preprocessor">#include &lt;sstream&gt;</span>
<span class="preprocessor">#include &lt;stdio.h&gt;</span>
<span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<span class="preprocessor">#include &lt;time.h&gt;</span>
<span class="preprocessor">#include &lt;math.h&gt;</span>
<span class="preprocessor">#include &lt;string.h&gt;</span>
<span class="preprocessor">#include &lt;signal.h&gt;</span>
<span class="preprocessor">#include &lt;sys/timeb.h&gt;</span>
<span class="preprocessor">#include &quot;DCSServer.h&quot;</span>
<span class="preprocessor">#include &quot;Constants/ConstantsUnits.h&quot;</span>

<span class="preprocessor">#ifdef WIN32</span>
<span class="preprocessor"></span><span class="preprocessor">#include &lt;conio.h&gt;</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

<span class="preprocessor">#define MAXPLAT 10   // Maximum number of platforms to create</span>
<span class="preprocessor"></span><span class="preprocessor">#define PLATTIME 1   // New platform every 1 second</span>
<span class="preprocessor"></span><span class="preprocessor">#define ECITRACKNUMBER ((MAXPLAT*3)+1)</span>
<span class="preprocessor"></span>

<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// Convienent math defines</span>

<span class="preprocessor">#ifndef M_PI</span>
<span class="preprocessor"></span><span class="preprocessor">#define M_PI 3.1415926535897932384626433832795</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
<span class="preprocessor">#ifndef DEG2RAD</span>
<span class="preprocessor"></span><span class="preprocessor">#define DEG2RAD 0.017453292519943295769236907684886</span>
<span class="preprocessor"></span><span class="preprocessor">#endif</span>
<span class="preprocessor"></span>

<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// Reference origin for scenario</span>

<span class="preprocessor">#define REFLAT (22.0*DEG2RAD)</span>
<span class="preprocessor"></span><span class="preprocessor">#define REFLON (-159.0*DEG2RAD)</span>
<span class="preprocessor"></span>

<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// Arrays of colors, used for beams and gates</span>
uint32_t bcolors[10] = {0xFF0000FF,0xFFFFFFFF,0x0000FFFF,0x000000FF,0xFF0000FF,
                        0x00FF00FF,0x0000FFFF,0xFFFF00FF,0xFF00FFFF,0x00FFFFFF};
uint32_t gcolors[10] = {0x00FFFFFF,0xFF00FFFF,0xFFFF00FF,0x0000FFFF,0x00FF00FF,
                        0xFF0000FF,0x000000FF,0xFF0000FF,0xFFFFFFFF,0x0000FFFF};


<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// flag to denote the server&#39;s status</span>
<span class="keywordtype">int</span> running(1);

<span class="keywordtype">bool</span> deletedPlatform(<span class="keyword">false</span>);
<span class="keywordtype">bool</span> deletedBeam(<span class="keyword">false</span>);
<span class="keywordtype">bool</span> deletedGate(<span class="keyword">false</span>);
<span class="keywordtype">double</span> deletedTime(0);


<span class="comment">// In order to properly stop the server, we set a signal that allows</span>
<span class="comment">// the user to stop the process by pressing Ctl C</span>
<span class="keywordtype">void</span> dcsserverInterrupt()
{
  signal(SIGINT,SIG_IGN);
  cout &lt;&lt; <span class="stringliteral">&quot;SimpleDCSServer interrupt called&quot;</span> &lt;&lt; endl;
  <span class="keywordflow">if</span> (running)
  {
    running = <span class="keyword">false</span>;
  }
  <span class="keywordflow">else</span>
  {
    exit(0);
  }
}


<span class="comment">// fixes angles, in radians, between 0 and two PI</span>
<span class="keyword">inline</span> <span class="keywordtype">double</span> ANGFIX(<span class="keywordtype">double</span> x)
{
  <span class="keywordflow">return</span> ((x = fmod(x,(M_PI*2.0)))&lt;0.0)?(x+(M_PI*2.0)):x;
}


<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// Time in seconds since the beginning of the year</span>
<span class="keywordtype">double</span> yeartime()
{
  <span class="keyword">struct </span>timeval tp;

  <span class="comment">// get the current system time, using timezone value of 0</span>
  <span class="comment">// returns UTC time</span>
  gettimeofday(&amp;tp, 0);

  <span class="comment">// put system time into a tm struct</span>
  time_t t(tp.tv_sec);
  <span class="keyword">struct </span>tm* p_time = gmtime(&amp;t);

  <span class="comment">// assemble a UTC &quot;system time&quot;</span>
  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> p_secs = (<span class="keywordtype">unsigned</span> int)(p_time-&gt;tm_sec )  +
    (((<span class="keywordtype">unsigned</span> int)(p_time-&gt;tm_min )) * 60) +
    (((<span class="keywordtype">unsigned</span> int)(p_time-&gt;tm_hour)) * 60*60) +
    (((<span class="keywordtype">unsigned</span> int)(p_time-&gt;tm_yday)) * 60*60*24);
  
  <span class="keywordflow">return</span> (p_secs + (tp.tv_usec * 1e-06));
}

<span class="keywordtype">int</span> sendPlotData (<a class="code" href="classDCSServer.html" title="A top level class for implementing a DCS data server.">DCSServer</a>* dcsServer, uint64_t <span class="keywordtype">id</span>, <span class="keywordtype">double</span> dtime, <span class="keywordtype">double</span> pctVal)
{
<span class="preprocessor">#define PLOTSIZE 100</span>
<span class="preprocessor"></span>  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> STARTX = 500;
  <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">double</span> INCREMENTX = 20;
  <span class="comment">// Create an array of data to send</span>
  <span class="keywordtype">float</span> dataArray[PLOTSIZE];
  <span class="keywordtype">int</span> k;
  <span class="keywordflow">for</span> (k = 0; k &lt; PLOTSIZE; ++k)
  {
    <span class="keywordtype">double</span> randNum = (rand() % 100) * 0.1; <span class="comment">// Random number between 0 and 10</span>
    dataArray[k] = (float)randNum;
    <span class="comment">// Add a spike around a regular area</span>
    <span class="keywordtype">double</span> curPct = ((double)k) / PLOTSIZE;
    <span class="keywordflow">if</span> ((curPct &gt; pctVal - 0.1) &amp;&amp; (curPct &lt; pctVal + 0.1))
      dataArray[k] += 150;
  }
  <span class="comment">// Set up a gate to focus on the &quot;high&quot; value</span>
  <a class="code" href="structDCSScopeGateData.html" title="Scope Gate Data struct.">DCSScopeGateData</a> gate;
  gate.<a class="code" href="structDCSScopeGateData.html#a3de79e0f1685f443290d403266e5fc78" title="The id of this Scope Gate, unique between the Gates aggregated by an instance of ScopeData.">id_</a> = 1;
  gate.<a class="code" href="structDCSScopeGateData.html#a37460da378f0e0bde657a1662042c0a0" title="The &quot;center&quot; x position of the gate (units=DCSScopeData::xUnits_, not necesarily halfway between star...">center_</a> = STARTX + pctVal * PLOTSIZE * INCREMENTX;
  gate.<a class="code" href="structDCSScopeGateData.html#a4141e53f281bf440ebee5c6767d8c63e" title="The starting x position of the gate (units=DCSScopeData::xUnits_)">start_</a> = gate.<a class="code" href="structDCSScopeGateData.html#a37460da378f0e0bde657a1662042c0a0" title="The &quot;center&quot; x position of the gate (units=DCSScopeData::xUnits_, not necesarily halfway between star...">center_</a> - 35;
  gate.<a class="code" href="structDCSScopeGateData.html#ae8847bd3f3dbe45833d49ec8d5057044" title="The ending x position of the gate (units=DCSScopeData::xUnits_)">end_</a> = gate.<a class="code" href="structDCSScopeGateData.html#a37460da378f0e0bde657a1662042c0a0" title="The &quot;center&quot; x position of the gate (units=DCSScopeData::xUnits_, not necesarily halfway between star...">center_</a> + 45;
  <span class="comment">// Send off the array</span>
  dcsServer-&gt;<a class="code" href="classDCSServer.html#a2812be0811cd723aa8d0b7cb98563f85" title="Send scope data to the client.">sendScopeData</a> (<span class="keywordtype">id</span>,
                            UTILS::CU_METERS,   <span class="comment">/* units, meters */</span>
                            UTILS::CU_VOLT,     <span class="comment">/* units, volts */</span>
                            dtime,              <span class="comment">/* time of plot */</span>
                            STARTX,             <span class="comment">/* start of X (500 meters out) */</span>
                            INCREMENTX,         <span class="comment">/* Increment for X (20 meters each point) */</span>
                            0,                  <span class="comment">/* Y Bias (none, start at 0) */</span>
                            1,                  <span class="comment">/* Y Scale (scale at 1x data) */</span>
                            PLOTSIZE,           <span class="comment">/* Number of data points in array */</span>
                            UTILS::vtFLOAT32,   <span class="comment">/* Data is stored as 4-byte floats */</span>
                            1,                  <span class="comment">/* Number of gates */</span>
                            (<span class="keywordtype">void</span>*)dataArray,   <span class="comment">/* Array of data to send */</span>
                            &amp;gate);             <span class="comment">/* Gate to send */</span>
  <span class="keywordflow">return</span> 0;
}


<span class="comment">// // // // // // // // // // // // // // // // // // // // // // //</span>
<span class="comment">// main program loop</span>
<span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** argv)
{
  <span class="comment">// The current platform id.  It will be incremented each time we create</span>
  <span class="comment">// a new platform in order to assign a unique id to each data set.</span>
  int32_t <span class="keywordtype">id</span> = 0;
  int32_t i = 0;
  int8_t datamode = <a class="code" href="DCSdefs_8h.html#a8f662097696a06425380ceaec3900b05a109d67eee74810df5291fa5623eb1cc6">DCSDATA_MULTICAST</a>;
  std::stringstream sstr;

  <span class="comment">// Values for updating beam and gate states</span>
  <span class="keywordtype">double</span> lasttime = 0.0;
  <span class="keywordtype">bool</span> beamon = <span class="keyword">true</span>;
  int32_t coloroffset = 0;
  int32_t targetID = 1;

  <span class="comment">// First check command line args</span>
  <span class="keywordflow">if</span> (argc &gt; 1)
  {
    <span class="keywordflow">if</span> (argc &gt; 2 || strcmp(argv[1], <span class="stringliteral">&quot;-h&quot;</span>) == 0)
    {
      printf(<span class="stringliteral">&quot;Usage: %s [-h | -unicast | -broadcast | -multicast]\n&quot;</span>, argv[0]);
      <span class="keywordflow">return</span> 0;
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(argv[1], <span class="stringliteral">&quot;-unicast&quot;</span>) == 0)
      datamode = <a class="code" href="DCSdefs_8h.html#a8f662097696a06425380ceaec3900b05a46e1c2f4219add89da21744a6b125fe3">DCSDATA_UNICAST</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(argv[1], <span class="stringliteral">&quot;-broadcast&quot;</span>) == 0)
      datamode = <a class="code" href="DCSdefs_8h.html#a8f662097696a06425380ceaec3900b05aedc3c9c4a6e599c8df83b48c841b9fc9">DCSDATA_BROADCAST</a>;
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp(argv[1], <span class="stringliteral">&quot;-multicast&quot;</span>) == 0)
      datamode = <a class="code" href="DCSdefs_8h.html#a8f662097696a06425380ceaec3900b05a109d67eee74810df5291fa5623eb1cc6">DCSDATA_MULTICAST</a>;
    <span class="keywordflow">else</span>
    {
      printf(<span class="stringliteral">&quot;Usage: %s [-h | -unicast | -broadcast | -multicast]\n&quot;</span>, argv[0]);
      <span class="keywordflow">return</span> 0;
    }
  }

  <span class="comment">// In order to properly stop the server, we set a signal that</span>
  <span class="comment">// allows the user to stop the process by pressing Ctl C.</span>
<span class="preprocessor">#ifdef WIN32</span>
<span class="preprocessor"></span>  signal(SIGINT,(<span class="keywordtype">void</span>(*)(int32_t))dcsserverInterrupt);
  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press Q key to quit DCS Server&quot;</span> &lt;&lt; endl;
  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press P key to delete platform 1&quot;</span> &lt;&lt; endl;
  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press B key to delete beam 11&quot;</span> &lt;&lt; endl;
  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press G key to delete gate 21&quot;</span> &lt;&lt; endl;
  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press C key to clear the database file&quot;</span> &lt;&lt; endl;
  cout &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span> &lt;&lt; endl;
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  cout &lt;&lt; <span class="stringliteral">&quot;\n\t Press Ctl-C key to quit DCS Server\n&quot;</span> &lt;&lt; endl;
  <span class="keyword">struct </span>sigaction act;
  act.sa_handler=(void(*)(int32_t))dcsserverInterrupt;
  sigemptyset(&amp;act.sa_mask);
  act.sa_flags=0;
<span class="preprocessor">#ifdef SA_RESTART</span>
<span class="preprocessor"></span>  act.sa_flags|=SA_RESTART;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  sigaction(SIGINT,&amp;act,NULL);
  
  <span class="comment">// Ignore SIGPIPE which will cause an exit when</span>
  <span class="comment">// reading from a broken socket more than once.</span>
  <span class="comment">// This only affects UNIX machines, Sun &amp; Linux in particular</span>
  signal(SIGPIPE,SIG_IGN);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
  <span class="comment">// remove old DCS database files</span>
  <span class="keywordtype">char</span> sysCmd[128];
<span class="preprocessor">#ifdef WIN32</span>
<span class="preprocessor"></span>  strncpy(sysCmd,<span class="stringliteral">&quot;del *_dcsSRV.dat&quot;</span>, <span class="keyword">sizeof</span>(sysCmd)-1);
<span class="preprocessor">#else</span>
<span class="preprocessor"></span>  strncpy(sysCmd,<span class="stringliteral">&quot;rm -f *_dcsSRV.dat&quot;</span>, <span class="keyword">sizeof</span>(sysCmd)-1);
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>  <span class="keywordtype">int</span> sysrv = system (sysCmd);

  <span class="comment">// Get current time &amp; year for scenario</span>
  time_t t = time(NULL);
  <span class="keyword">struct </span>tm* gmt = gmtime(&amp;t);
  <span class="keywordtype">int</span> currentYear = gmt-&gt;tm_year+1900;
  <span class="keywordtype">double</span> dtime = yeartime();

  <span class="comment">// DCSServer constructor, facilitates the creation, setup and sending of </span>
  <span class="comment">// data via the NRL developed DCS protocol</span>
  <a class="code" href="classDCSServer.html" title="A top level class for implementing a DCS data server.">DCSServer</a> dcsServer(<span class="stringliteral">&quot;SimpleDCSServer&quot;</span>, datamode);

  <span class="comment">// Responsible for starting the DCS server based on</span>
  <span class="comment">// values set in the constructor.</span>
  dcsServer.<a class="code" href="classDCSServer.html#ab7b1d6193230adf92e9a55569109bb3c" title="DCSServer start.">start</a>();
  
  <span class="comment">// Sets expiration time limit (secs) for all objects,</span>
  <span class="comment">// value must be &gt; 0</span>
  dcsServer.<a class="code" href="classDCSServer.html#a8592f84c99b37d946d992eb443ad7edd" title="DCSServer setExpireTimeLimit.">setExpireTimeLimit</a>(300.);
  
  <span class="comment">// Sends scenario initialization information to the server</span>
  <span class="comment">// and subsequently to all connected clients.</span>
  dcsServer.<a class="code" href="classDCSServer.html#ad26e6bea54eaaa06e8dd97968bea8e13" title="DCSServer sendScenarioHeader.">sendScenarioHeader</a>(<a class="code" href="DCSdefs_8h.html#af707537cfdfcac94b52114141c4fcdf3acfd5ad6d1a641560a1793171a15a48ed">DCSCOORD_ENU</a>,
                               <a class="code" href="DCSdefs_8h.html#a10b9fbd7c72c8917a66c2cb2404c08bfa3720d47aa6bb77b1737415b5d71f009e">DCSCLASS_UNCLASSIFIED</a>,
                               currentYear,
                               REFLAT,
                               REFLON,
                               dtime,
                               1.0,
                               <a class="code" href="DCSdefs_8h.html#a4c9a4aede0cb8f0a067fd61c2f8264d0a9f2489b04250e973c54304134ca43f77">DCSTIME_PACKET</a>);

  <span class="comment">// main loop, data is created and sent via DCS until a Ctl C is</span>
  <span class="comment">// issued by the user</span>
  <span class="keywordtype">double</span> xpos, ypos, course;
  <span class="keywordtype">double</span> azim, elev;
  <span class="keywordtype">int</span> numPlats = 0;
  <span class="keywordtype">char</span> genericDataValue[72];
  <span class="keywordtype">double</span> toggleDuration = 4.0;
  <span class="keywordtype">bool</span> platformFourCreated = <span class="keyword">false</span>;
  elev = 15.0 * DEG2RAD;
  cout.precision(12);

  <span class="comment">// Create an ECI platform that is updated with a stationary point, thus using earth&#39;s rotation to move</span>
  <span class="keywordtype">double</span> eciRefTime = yeartime();
  dcsServer.<a class="code" href="classDCSServer.html#aaead8e501c05923ef9f5334ea8dd0639" title="DCSServer sendPlatformHeader.">sendPlatformHeader</a>(ECITRACKNUMBER,          <span class="comment">/* platform id */</span>
                               <span class="stringliteral">&quot;ECI Platform&quot;</span>,          <span class="comment">/* Platform name */</span>
                               <span class="stringliteral">&quot;unit_sphere&quot;</span>,           <span class="comment">/* Icon name */</span>
                               <a class="code" href="DCSdefs_8h.html#af707537cfdfcac94b52114141c4fcdf3aba5efb2599f875b20cbde328f45eabab">DCSCOORD_ECI</a>,            <span class="comment">/* ECI coordinate system */</span>
                               REFLAT, REFLON, 0.0,     <span class="comment">/* Reference LLA */</span>
                               <a class="code" href="DCSdefs_8h.html#a02968ce1a311abe1b434c657f97821aea4fb11710226f289b7851bd5a9cbdfe90">DCSVERTDATUM_WGS84</a>, 0.0, <span class="comment">/* Vertical datum */</span>
                               <a class="code" href="DCSdefs_8h.html#a6b2bf78ef9c5299a54092bbdb7eaf09ca1fd4ceb258beef74dfe06fa8df2de49c">DCSMAGVAR_TRUE</a>, 0.0,     <span class="comment">/* Magnetic variance */</span>
                               eciRefTime,              <span class="comment">/* ECI Reference time */</span>
                               0.0, 0.0, 0.0,           <span class="comment">/* GTP offsets: ignored in this case since we&#39;re not using GTP */</span>
                               eciRefTime,              <span class="comment">/* Data time */</span>
                               -5559677.61765208,       <span class="comment">/* X */</span>
                               -2023557.16494139,       <span class="comment">/* Y */</span>
                               2374412.89530282,        <span class="comment">/* Z */</span>
                               0,                       <span class="comment">/* course */</span>
                               0,                       <span class="comment">/* pitch */</span>
                               0.,                      <span class="comment">/* roll */</span>
                               0., 0., 0.,              <span class="comment">/* vx, vy, vz */</span>
                               0., 0., 0.);             <span class="comment">/* ax, ay, az */</span>
  dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (31, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), dtime);
  dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (31, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), dtime);

  <span class="comment">// Continuously loop until done</span>
  <span class="keywordflow">while</span> (running)
  {
    <span class="comment">// Get our data here.  The data can come from any source such as</span>
    <span class="comment">// The network or a file.  In this example it is made up.</span>
    dtime = yeartime();

    <span class="comment">// Generate sample position data</span>
    xpos = 100 * (sin(dtime * 0.01));
    ypos = 100 * (cos(dtime * 0.01));
 
    <span class="comment">// Generate sample orientation data</span>
    course = sin(ANGFIX((M_PI * .5) + (dtime * 0.1)));

    <span class="comment">// Generate sample azimuth beam &amp; gate pointing data</span>
    azim = ANGFIX(dtime * DEG2RAD);

    <span class="comment">// Update the ECI track.  It is a static point that uses the earth&#39;s rotation to rotate</span>
    dcsServer.<a class="code" href="classDCSServer.html#aefba8d37647106e87ead329dece89974" title="DCSServer sendPlatformData.">sendPlatformData</a>(31,
                               dtime,
                               -5559677.61765208,       <span class="comment">/* X */</span>
                               -2023557.16494139,       <span class="comment">/* Y */</span>
                               2374412.89530282,        <span class="comment">/* Z */</span>
                               0,                       <span class="comment">/* course */</span>
                               0,                       <span class="comment">/* pitch */</span>
                               0.,                      <span class="comment">/* roll */</span>
                               0., 0., 0.,              <span class="comment">/* vx, vy, vz */</span>
                               0., 0., 0.);             <span class="comment">/* ax, ay, az */</span>

    <span class="comment">// add a new data set every few seconds until the max number is defined</span>
    time_t test = time(NULL)-t;
    <span class="keywordflow">if</span> ((numPlats &lt; (MAXPLAT*3)) &amp;&amp; (test/PLATTIME) &gt; (<span class="keywordtype">id</span>-1))
    {
      <span class="comment">// increment platform count</span>
      numPlats += 3;
      <span class="comment">// increment unique id</span>
      ++id;

      <span class="comment">// Sends platform initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> callsign[64];
      <span class="keywordtype">char</span> iconname[32];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; <span class="keywordtype">id</span> &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl&quot;</span>;
      strncpy(callsign, sstr.str().c_str(), <span class="keyword">sizeof</span>(callsign)-1);
      strncpy(iconname, <span class="stringliteral">&quot;p-3c_orion_nrl&quot;</span>, <span class="keyword">sizeof</span>(iconname)-1);
      dcsServer.<a class="code" href="classDCSServer.html#aaead8e501c05923ef9f5334ea8dd0639" title="DCSServer sendPlatformHeader.">sendPlatformHeader</a>(<span class="keywordtype">id</span>,         <span class="comment">/* platform id */</span>
                                   callsign,
                                   iconname,
                                   (<span class="keywordtype">id</span> == 1 || <span class="keywordtype">id</span> == 10) ? <a class="code" href="DCSdefs_8h.html#af707537cfdfcac94b52114141c4fcdf3af9e8f8baa5f647e5e2fb586b10c5134d">DCSCOORD_GTP</a> : <a class="code" href="DCSdefs_8h.html#af707537cfdfcac94b52114141c4fcdf3acfd5ad6d1a641560a1793171a15a48ed">DCSCOORD_ENU</a>,
                                   REFLAT, REFLON, 0.0,         <span class="comment">/* Reference LLA */</span>
                                   <a class="code" href="DCSdefs_8h.html#a02968ce1a311abe1b434c657f97821aea4fb11710226f289b7851bd5a9cbdfe90">DCSVERTDATUM_WGS84</a>, 0.0,     <span class="comment">/* Veritcal Datum */</span>
                                   <a class="code" href="DCSdefs_8h.html#a6b2bf78ef9c5299a54092bbdb7eaf09ca1fd4ceb258beef74dfe06fa8df2de49c">DCSMAGVAR_TRUE</a>, 0.0,         <span class="comment">/* Magnetic variance */</span>
                                   0.0,                         <span class="comment">/* ECI Reference Time */</span>
                                   0.0, 950, 90 * DEG2RAD,      <span class="comment">/* GTP X/Y/Angle offsets; ignored if not GTP */</span>
                                   dtime,                       <span class="comment">/* Data time */</span>
                                   xpos + ((<span class="keywordtype">id</span> - 1) * 100),     <span class="comment">/* X position in tangential system */</span>
                                   ypos + ((<span class="keywordtype">id</span> - 1) * 100),     <span class="comment">/* Y position in tangential system */</span>
                                   100.,        <span class="comment">/* Z */</span>
                                   course,
                                   (<span class="keywordtype">id</span> == 4) ? 20. * DEG2RAD : 0., <span class="comment">/* pitch */</span>
                                   (<span class="keywordtype">id</span> == 4) ? 15. * DEG2RAD : 0., <span class="comment">/* roll */</span>
                                   (<span class="keywordtype">id</span> == 4) ? 1. : 0.,  <span class="comment">/* vx */</span>
                                   (<span class="keywordtype">id</span> == 4) ? 2. : 0.,  <span class="comment">/* vy */</span>
                                   (<span class="keywordtype">id</span> == 4) ? 3. : 0.,  <span class="comment">/* vz */</span>
                                   4., 5., 6.); <span class="comment">/* ax, ay, az */</span>
      dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (<span class="keywordtype">id</span>, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), dtime);
      dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (<span class="keywordtype">id</span>, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), dtime);

      <a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379" title="Supported beam types.">DCSBeamType_t</a> beamtype(<a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379a6c716b29e3b47bc22fab8d1bea88bdbc">DCSBEAM_LINEAR</a>);
      <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 4)
      {
        <span class="comment">// Set the beam on platform &#39;4&#39; to use a steady (track) beam type instead</span>
        <span class="comment">// of a linear beam type.  Set the beam&#39;s target id and beam type.</span>
        beamtype = <a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379a20c55ecca120f45a3026e4d3111a98bb">DCSBEAM_STEADY</a>;
      }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 9)
      {
        <span class="comment">// Set the beam on platform &#39;9&#39; to use a body axis relative beam type instead</span>
        <span class="comment">// of a linear beam type.  Set the beam&#39;s target id and beam type.</span>
        beamtype = <a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379a2728630dd80bb606bf562379bb9bdd65">DCSBEAM_BODYAXIS</a>;
      }
      
      <span class="comment">// Sends beam initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> beamdesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; <span class="keywordtype">id</span>+MAXPLAT &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl beam&quot;</span>;
      strncpy(beamdesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(beamdesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#a0ec137e305d101c4572abd9134b5cc7a" title="DCSServer sendBeamHeader.">sendBeamHeader</a>(<span class="keywordtype">id</span>+MAXPLAT,  <span class="comment">/* beam id */</span>
                               <span class="keywordtype">id</span>,          <span class="comment">/* host id */</span>
                               beamdesc,
                               3 * DEG2RAD, <span class="comment">/* hbw */</span>
                               3 * DEG2RAD, <span class="comment">/* vbw */</span>
                               targetID,
                               bcolors[<span class="keywordtype">id</span>-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               5.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               1.,  <span class="comment">/* z body offset */</span>
                               beamtype,
                               dtime,
                               azim,
                               elev,
                               (<span class="keywordtype">id</span> == 4) ?   0. : 300.0); <span class="comment">/* range */</span>

      <span class="comment">// Sends gate initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> gatedesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; <span class="keywordtype">id</span>+(MAXPLAT*2) &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl gate&quot;</span>;
      strncpy(gatedesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(gatedesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#ae9ea2adcc14b9295af4ee6405b96b5c2" title="DCSServer sendGateHeader.">sendGateHeader</a>(<span class="keywordtype">id</span>+(MAXPLAT*2),  <span class="comment">/* gate id */</span>
                               <span class="keywordtype">id</span>+MAXPLAT,      <span class="comment">/* host id */</span>
                               gatedesc,
                               gcolors[<span class="keywordtype">id</span>-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               0.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               0.,  <span class="comment">/* z body offset */</span>
                               <a class="code" href="DCSdefs_8h.html#a4d470476616e03eba5833f8a022f0722a8780f2cb3dcfdfc5183713ba7995c87b">DCSGATE_RANGE</a>,
                               dtime,
                               azim,
                               elev,
                               3.0 * DEG2RAD,      <span class="comment">/* width, i.e. hbw */</span>
                               3.0 * DEG2RAD,      <span class="comment">/* height, i.e. vbw */</span>
                               (<span class="keywordtype">id</span> == 4) ? -10. : 280.0,  <span class="comment">/* min range */</span>
                               (<span class="keywordtype">id</span> == 4) ?   0. : 290.0,  <span class="comment">/* cen range */</span>
                               (<span class="keywordtype">id</span> == 4) ?  10. : 300.0); <span class="comment">/* max range */</span>
    } <span class="comment">// end of header data</span>


    <span class="keywordflow">if</span> (deletedPlatform &amp;&amp; deletedTime &lt; dtime)
    {
      cout &lt;&lt; <span class="stringliteral">&quot;Re-adding Platform 1&quot;</span> &lt;&lt; endl;
      int32_t deletedID = 1;
      <span class="keywordtype">char</span> callsign[64];
      <span class="keywordtype">char</span> iconname[32];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl&quot;</span>;
      strncpy(callsign, sstr.str().c_str(), <span class="keyword">sizeof</span>(callsign)-1);
      strncpy(iconname, <span class="stringliteral">&quot;p-3c_orion_nrl&quot;</span>, <span class="keyword">sizeof</span>(iconname)-1);
      dcsServer.<a class="code" href="classDCSServer.html#aaead8e501c05923ef9f5334ea8dd0639" title="DCSServer sendPlatformHeader.">sendPlatformHeader</a>(deletedID,         <span class="comment">/* platform id */</span>
                                   callsign,
                                   iconname,
                                   <a class="code" href="DCSdefs_8h.html#af707537cfdfcac94b52114141c4fcdf3af9e8f8baa5f647e5e2fb586b10c5134d">DCSCOORD_GTP</a>,
                                   REFLAT, REFLON, 0.0,         <span class="comment">/* Reference LLA */</span>
                                   <a class="code" href="DCSdefs_8h.html#a02968ce1a311abe1b434c657f97821aea4fb11710226f289b7851bd5a9cbdfe90">DCSVERTDATUM_WGS84</a>, 0.0,     <span class="comment">/* Veritcal Datum */</span>
                                   <a class="code" href="DCSdefs_8h.html#a6b2bf78ef9c5299a54092bbdb7eaf09ca1fd4ceb258beef74dfe06fa8df2de49c">DCSMAGVAR_TRUE</a>, 0.0,         <span class="comment">/* Magnetic variance */</span>
                                   0.0,                         <span class="comment">/* ECI Reference Time */</span>
                                   0.0, 950, 90 * DEG2RAD,      <span class="comment">/* GTP X/Y/Angle offsets; ignored if not GTP */</span>
                                   dtime,                       <span class="comment">/* Data time */</span>
                                   xpos + ((deletedID - 1) * 100),      <span class="comment">/* X position in tangential system */</span>
                                   ypos + ((deletedID - 1) * 100),      <span class="comment">/* Y position in tangential system */</span>
                                   100.,        <span class="comment">/* Z */</span>
                                   course,
                                   0.,          <span class="comment">/* pitch */</span>
                                   0.,          <span class="comment">/* roll */</span>
                                   0., 0., 0.,  <span class="comment">/* vx, vy, vz */</span>
                                   0., 0., 0.); <span class="comment">/* ax, ay, az */</span>
      dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (deletedID, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a714395f3b145bf5e2d8533872e791d11a108b3d3001ce35fe3657286fe29d09e2">DCSPLATFORM_AIRCRAFT</a>), dtime);
      dcsServer.<a class="code" href="classDCSServer.html#a699f2c5ca7323d83d4db416ae1607ac2" title="DCSServer sendCategoryData.">sendCategoryData</a> (deletedID, DCS::getCategoryName (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), DCS::getCategoryValue (<a class="code" href="DCSdefs_8h.html#a37d8201ec932256ff86b0377b05b97ccacb0f8524984ea8f187fcf9954d5851ac">DCSALLEGIENCE_FRIENDLY</a>), dtime);

      <a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379" title="Supported beam types.">DCSBeamType_t</a> beamtype(<a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379a6c716b29e3b47bc22fab8d1bea88bdbc">DCSBEAM_LINEAR</a>);      
      <span class="comment">// Sends beam initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> beamdesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID+MAXPLAT &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl beam&quot;</span>;
      strncpy(beamdesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(beamdesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#a0ec137e305d101c4572abd9134b5cc7a" title="DCSServer sendBeamHeader.">sendBeamHeader</a>(deletedID+MAXPLAT,  <span class="comment">/* beam id */</span>
                               deletedID,          <span class="comment">/* host id */</span>
                               beamdesc,
                               3 * DEG2RAD, <span class="comment">/* hbw */</span>
                               3 * DEG2RAD, <span class="comment">/* vbw */</span>
                               targetID,
                               bcolors[deletedID-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               5.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               1.,  <span class="comment">/* z body offset */</span>
                               beamtype,
                               dtime,
                               azim,
                               elev,
                               300.0); <span class="comment">/* range */</span>

      <span class="comment">// Sends gate initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> gatedesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID+(MAXPLAT*2) &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl gate&quot;</span>;
      strncpy(gatedesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(gatedesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#ae9ea2adcc14b9295af4ee6405b96b5c2" title="DCSServer sendGateHeader.">sendGateHeader</a>(deletedID+(MAXPLAT*2),  <span class="comment">/* gate id */</span>
                               deletedID+MAXPLAT,      <span class="comment">/* host id */</span>
                               gatedesc,
                               gcolors[deletedID-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               0.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               0.,  <span class="comment">/* z body offset */</span>
                               <a class="code" href="DCSdefs_8h.html#a4d470476616e03eba5833f8a022f0722a8780f2cb3dcfdfc5183713ba7995c87b">DCSGATE_RANGE</a>,
                               dtime,
                               azim,
                               elev,
                               3.0 * DEG2RAD,      <span class="comment">/* width, i.e. hbw */</span>
                               3.0 * DEG2RAD,      <span class="comment">/* height, i.e. vbw */</span>
                               280.0,  <span class="comment">/* min range */</span>
                               290.0,  <span class="comment">/* cen range */</span>
                               300.0); <span class="comment">/* max range */</span>
      deletedPlatform = <span class="keyword">false</span>;
      deletedTime = 0;
    } <span class="comment">// end of re-adding deleted header data</span>

    
    <span class="keywordflow">if</span> (deletedBeam &amp;&amp; deletedTime &lt; dtime)
    {
      cout &lt;&lt; <span class="stringliteral">&quot;Re-adding Beam 11&quot;</span> &lt;&lt; endl;
      int32_t deletedID = 1;

      <a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379" title="Supported beam types.">DCSBeamType_t</a> beamtype(<a class="code" href="DCSdefs_8h.html#ac65e1ed2cac0b8d2d0346154aa094379a6c716b29e3b47bc22fab8d1bea88bdbc">DCSBEAM_LINEAR</a>);      
      <span class="comment">// Sends beam initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> beamdesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID+MAXPLAT &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl beam&quot;</span>;
      strncpy(beamdesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(beamdesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#a0ec137e305d101c4572abd9134b5cc7a" title="DCSServer sendBeamHeader.">sendBeamHeader</a>(deletedID+MAXPLAT,  <span class="comment">/* beam id */</span>
                               deletedID,          <span class="comment">/* host id */</span>
                               beamdesc,
                               3 * DEG2RAD, <span class="comment">/* hbw */</span>
                               3 * DEG2RAD, <span class="comment">/* vbw */</span>
                               targetID,
                               bcolors[deletedID-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               5.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               1.,  <span class="comment">/* z body offset */</span>
                               beamtype,
                               dtime,
                               azim,
                               elev,
                               300.0); <span class="comment">/* range */</span>

      <span class="comment">// Sends gate initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> gatedesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID+(MAXPLAT*2) &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl gate&quot;</span>;
      strncpy(gatedesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(gatedesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#ae9ea2adcc14b9295af4ee6405b96b5c2" title="DCSServer sendGateHeader.">sendGateHeader</a>(deletedID+(MAXPLAT*2),  <span class="comment">/* gate id */</span>
                               deletedID+MAXPLAT,      <span class="comment">/* host id */</span>
                               gatedesc,
                               gcolors[deletedID-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               0.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               0.,  <span class="comment">/* z body offset */</span>
                               <a class="code" href="DCSdefs_8h.html#a4d470476616e03eba5833f8a022f0722a8780f2cb3dcfdfc5183713ba7995c87b">DCSGATE_RANGE</a>,
                               dtime,
                               azim,
                               elev,
                               3.0 * DEG2RAD,      <span class="comment">/* width, i.e. hbw */</span>
                               3.0 * DEG2RAD,      <span class="comment">/* height, i.e. vbw */</span>
                               280.0,  <span class="comment">/* min range */</span>
                               290.0,  <span class="comment">/* cen range */</span>
                               300.0); <span class="comment">/* max range */</span>
      deletedBeam = <span class="keyword">false</span>;
      deletedTime = 0;
    } <span class="comment">// end of re-adding deleted header data</span>

    
    <span class="keywordflow">if</span> (deletedGate &amp;&amp; deletedTime &lt; dtime)
    {
      cout &lt;&lt; <span class="stringliteral">&quot;Re-adding Gate 21&quot;</span> &lt;&lt; endl;
      int32_t deletedID = 1;

      <span class="comment">// Sends gate initialization information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      <span class="keywordtype">char</span> gatedesc[64];
      sstr.str(<span class="stringliteral">&quot;&quot;</span>);
      sstr &lt;&lt; deletedID+(MAXPLAT*2) &lt;&lt; <span class="stringliteral">&quot; p-3c_orion_nrl gate&quot;</span>;
      strncpy(gatedesc, sstr.str().c_str(), <span class="keyword">sizeof</span>(gatedesc)-1);
      dcsServer.<a class="code" href="classDCSServer.html#ae9ea2adcc14b9295af4ee6405b96b5c2" title="DCSServer sendGateHeader.">sendGateHeader</a>(deletedID+(MAXPLAT*2),  <span class="comment">/* gate id */</span>
                               deletedID+MAXPLAT,      <span class="comment">/* host id */</span>
                               gatedesc,
                               gcolors[deletedID-1],
                               0.,  <span class="comment">/* azim offset */</span>
                               0.,  <span class="comment">/* elev offset */</span>
                               0.,  <span class="comment">/* x body offset */</span>
                               0.,  <span class="comment">/* y body offset */</span>
                               0.,  <span class="comment">/* z body offset */</span>
                               <a class="code" href="DCSdefs_8h.html#a4d470476616e03eba5833f8a022f0722a8780f2cb3dcfdfc5183713ba7995c87b">DCSGATE_RANGE</a>,
                               dtime,
                               azim,
                               elev,
                               3.0 * DEG2RAD,      <span class="comment">/* width, i.e. hbw */</span>
                               3.0 * DEG2RAD,      <span class="comment">/* height, i.e. vbw */</span>
                               280.0,  <span class="comment">/* min range */</span>
                               290.0,  <span class="comment">/* cen range */</span>
                               300.0); <span class="comment">/* max range */</span>
      deletedGate = <span class="keyword">false</span>;
      deletedTime = 0;
    } <span class="comment">// end of re-adding deleted header data</span>

    
    <span class="comment">// Update all data positions</span>
    int32_t startID = deletedPlatform ? 2 : 1;
    <span class="keywordflow">for</span> (i = startID; i &lt;= id; i++)
    {
      <span class="comment">// Updates platform position information to the server</span>
      <span class="comment">// and subsequently to all connected clients.</span>
      dcsServer.<a class="code" href="classDCSServer.html#aefba8d37647106e87ead329dece89974" title="DCSServer sendPlatformData.">sendPlatformData</a>(i,
                                 dtime,
                                 xpos + ((i - 1) * 100),
                                 ypos + ((i - 1) * 100),
                                 100.,        <span class="comment">/* Z */</span>
                                 course,
                                 (i == 4) ? 20.*DEG2RAD : 0., <span class="comment">/* pitch */</span>
                                 (i == 4) ? 15.*DEG2RAD : 0., <span class="comment">/* roll */</span>
                                 (i == 4) ? 1. : 0.,  <span class="comment">/* vx */</span>
                                 (i == 4) ? 2. : 0.,  <span class="comment">/* vy */</span>
                                 (i == 4) ? 3. : 0.,  <span class="comment">/* vz */</span>
                                 4., 5., 6.); <span class="comment">/* ax, ay, az */</span>
      
      <span class="keywordflow">if</span> (i == 4)
        platformFourCreated = <span class="keyword">true</span>;

      <span class="comment">// Do not update if we know beams are not displayed</span>
      <span class="keywordflow">if</span> (beamon)
      {
        <span class="keywordflow">if</span> (deletedBeam &amp;&amp; i == 1)
          <span class="keywordflow">continue</span>;
        <span class="keywordflow">else</span>
        {
          <span class="comment">// Updates beam position information to the server</span>
          <span class="comment">// and subsequently to all connected clients.</span>
          dcsServer.<a class="code" href="classDCSServer.html#a55b5af9ddf6ff4e12464882b9b6cae9a" title="DCSServer sendBeamData.">sendBeamData</a>(i+MAXPLAT,
                                 dtime,
                                 azim,
                                 elev,
                                 (i == 4) ?   0. : 300.0); <span class="comment">/* range */</span>

          <span class="keywordflow">if</span> (deletedGate &amp;&amp; i == 1)
            <span class="keywordflow">continue</span>;
          <span class="keywordflow">else</span>
          {
            <span class="comment">// Updates gate position information to the server</span>
            <span class="comment">// and subsequently to all connected clients.</span>
            dcsServer.<a class="code" href="classDCSServer.html#a5bed70b7319294966e996f69c5da3acc" title="DCSServer sendGateData.">sendGateData</a>(i+(MAXPLAT*2),
                                   dtime,
                                   azim,
                                   elev,
                                   3.0 * DEG2RAD,     <span class="comment">/* width, i.e. hbw */</span>
                                   3.0 * DEG2RAD,     <span class="comment">/* height, i.e. vbw */</span>
                                   (i == 4) ? -10. : 280.0,  <span class="comment">/* min range */</span>
                                   (i == 4) ?   0. : 290.0,  <span class="comment">/* cen range */</span>
                                   (i == 4) ?  10. : 300.0); <span class="comment">/* max range */</span>
          }
        }
      } <span class="comment">// end of if (beamon)</span>

      <span class="comment">// Now update beam and gate states, and change the colors</span>
      <span class="keywordflow">if</span> (dtime-lasttime &gt; toggleDuration)
      {
        <span class="comment">// Sends on|off state events for all objects to the server</span>
        <span class="comment">// and subsequently to all connected clients.</span>
        <span class="comment">// send beam state change event</span>
        dcsServer.<a class="code" href="classDCSServer.html#a28a00ff334eff082bad4be9a5689f03c" title="DCSServer sendStateEvent.">sendStateEvent</a>(i+MAXPLAT, beamon, dtime);

        <span class="comment">// Sends on|off state events for all objects to the server</span>
        <span class="comment">// and subsequently to all connected clients.</span>
        <span class="comment">// send gate state event</span>
        dcsServer.<a class="code" href="classDCSServer.html#a28a00ff334eff082bad4be9a5689f03c" title="DCSServer sendStateEvent.">sendStateEvent</a>(i+(MAXPLAT*2), beamon, dtime);

        <span class="comment">// Do not update if we know beams are not displayed</span>
        <span class="keywordflow">if</span> (beamon)
        {         
          <span class="keywordflow">if</span> (deletedBeam &amp;&amp; i == 1)
            <span class="keywordflow">continue</span>;
          <span class="keywordflow">else</span>
          {
            <span class="comment">// Sends color change events for all objects to the server</span>
            <span class="comment">// and subsequently to all connected clients</span>
            <span class="comment">// send beam color event</span>
            dcsServer.<a class="code" href="classDCSServer.html#ab5fa44b00a3c68201802aa34406e7e05" title="DCSServer sendColorEvent.">sendColorEvent</a>(i+MAXPLAT, bcolors[(i+coloroffset)%10], dtime);

            <span class="keywordflow">if</span> (deletedBeam &amp;&amp; i == 1)
              <span class="keywordflow">continue</span>;
            <span class="keywordflow">else</span>
            {
              <span class="comment">// Sends color change events for all objects to the server</span>
              <span class="comment">// and subsequently to all connected clients</span>
              <span class="comment">// send gate color event</span>
              dcsServer.<a class="code" href="classDCSServer.html#ab5fa44b00a3c68201802aa34406e7e05" title="DCSServer sendColorEvent.">sendColorEvent</a>(i+(MAXPLAT*2), gcolors[(i+coloroffset)%10], dtime);
            }

            <span class="comment">// send beam target event.</span>
            <span class="comment">// As an example, cycle through all available &#39;targets&#39;</span>
            <span class="keywordflow">if</span> (i == 4)
            {
              ++targetID;
              <span class="comment">// prevent platform 4 from tracking itself</span>
              <span class="keywordflow">if</span> (targetID == 4)
              {
                targetID = 5;
              }
              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (targetID &gt; 10)
              {
                targetID = 1;
              }
              <span class="comment">// Sends target events for beams to the server</span>
              <span class="comment">// and subsequently to all connected clients.</span>
              dcsServer.<a class="code" href="classDCSServer.html#ab8784068f3dcfaee7488e0972e8a3129" title="DCSServer sendTargetEvent.">sendTargetEvent</a>(i+MAXPLAT, targetID, dtime);
            }     
          }
        } <span class="comment">// end of if (beamon)</span>
      }
    } <span class="comment">// end of for (i to id)</span>

    <span class="comment">// Events for next time</span>
    <span class="keywordflow">if</span> (dtime-lasttime &gt; toggleDuration)
    {
      <span class="comment">// information text generic data</span>
      memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
      strncpy(genericDataValue, beamon?<span class="stringliteral">&quot;Beams on&quot;</span>:<span class="stringliteral">&quot;Beams off&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
      dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(0, <span class="stringliteral">&quot;Simdis_InfoText&quot;</span>, genericDataValue, dtime, -1);

      <span class="comment">// verify platform four exists</span>
      <span class="keywordflow">if</span> (platformFourCreated == <span class="keyword">true</span>)
      {
        <span class="comment">// animated line generic data</span>
        memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
        strncpy(genericDataValue, beamon?<span class="stringliteral">&quot;entityid=3&quot;</span>:<span class="stringliteral">&quot;entityid=5&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
        dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(4, <span class="stringliteral">&quot;SIMDIS_AnimatedLine 1&quot;</span>, genericDataValue, dtime, -1);

        <span class="keywordflow">if</span> (beamon)
        {
          <span class="comment">// cylinder generic data</span>
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;x=-0.5,y=9,z=0,px=-1,py=0,pz=0,l=0,radiusNear=.5,radiusFar=0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(4, <span class="stringliteral">&quot;SIMDIS_Cylinder 1&quot;</span>, genericDataValue, dtime, -1);
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;x=-0.5,y=9,z=0,px=-1,py=0,pz=0,l=4,radiusNear=.5,radiusFar=0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(4, <span class="stringliteral">&quot;SIMDIS_Cylinder 1&quot;</span>, genericDataValue, dtime + (toggleDuration * 0.5), -1);
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;x=-0.5,y=9,z=0,px=-1,py=0,pz=0,l=0,radiusNear=.5,radiusFar=0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(4, <span class="stringliteral">&quot;SIMDIS_Cylinder 1&quot;</span>, genericDataValue, dtime + toggleDuration, -1);

          <span class="comment">// scale generic data</span>
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;1.0`1.0`1.0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(targetID, <span class="stringliteral">&quot;SIMDIS_ScaleXYZ&quot;</span>, genericDataValue, dtime, -1);
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;1.0`4.0`1.0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(targetID, <span class="stringliteral">&quot;SIMDIS_ScaleXYZ&quot;</span>, genericDataValue, dtime + (toggleDuration * 0.5), -1);
          memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
          strncpy(genericDataValue, <span class="stringliteral">&quot;1.0`1.0`1.0&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
          dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(targetID, <span class="stringliteral">&quot;SIMDIS_ScaleXYZ&quot;</span>, genericDataValue, dtime + toggleDuration, -1);
        }

        <span class="comment">// change icon</span>
        dcsServer.<a class="code" href="classDCSServer.html#a722147b62f84a26506408750bbe3479f" title="DCSServer sendIconNameEvent.">sendIconNameEvent</a>(4, (beamon?<span class="stringliteral">&quot;p-3c_orion_nrl&quot;</span>:<span class="stringliteral">&quot;lear-36&quot;</span>), dtime);

        <span class="comment">// change callsign</span>
        dcsServer.<a class="code" href="classDCSServer.html#ad1340cf148208c769f01e88e32920da7" title="DCSServer sendCallsignEvent.">sendCallsignEvent</a>(4, (beamon?<span class="stringliteral">&quot;Plane&quot;</span>:<span class="stringliteral">&quot;Jet&quot;</span>), dtime);
        dcsServer.<a class="code" href="classDCSServer.html#ad1340cf148208c769f01e88e32920da7" title="DCSServer sendCallsignEvent.">sendCallsignEvent</a>(14, (beamon?<span class="stringliteral">&quot;Plane Beam&quot;</span>:<span class="stringliteral">&quot;Jet Beam&quot;</span>), dtime);
        dcsServer.<a class="code" href="classDCSServer.html#ad1340cf148208c769f01e88e32920da7" title="DCSServer sendCallsignEvent.">sendCallsignEvent</a>(24, (beamon?<span class="stringliteral">&quot;Plane Gate&quot;</span>:<span class="stringliteral">&quot;Jet Gate&quot;</span>), dtime);

        <span class="comment">// change classification</span>
        dcsServer.<a class="code" href="classDCSServer.html#a0b7a2af09c057de2bb7ce565e30a4720" title="DCSServer sendClassificationEvent.">sendClassificationEvent</a>((beamon?<span class="stringliteral">&quot;GOTS&quot;</span>:<span class="stringliteral">&quot;SIMDIS&quot;</span>),(beamon?0xFF000060:0xFF00FF60), dtime);

        <span class="comment">// change SIMDIS track color</span>
        memset(genericDataValue, 0, <span class="keyword">sizeof</span>(genericDataValue));
        strncpy(genericDataValue, beamon?<span class="stringliteral">&quot;0xFF0000FF&quot;</span>:<span class="stringliteral">&quot;-1&quot;</span>, <span class="keyword">sizeof</span>(genericDataValue)-1);
        dcsServer.<a class="code" href="classDCSServer.html#ae67aa02c87c8153134663c08513a66a3" title="DCSServer sendGenericData.">sendGenericData</a>(4, <span class="stringliteral">&quot;SIMDIS_TrackColor&quot;</span>, genericDataValue, dtime, -1);
      }

      lasttime = dtime;
      beamon = !beamon;
      
      <span class="comment">// Increment color once for every blink</span>
      <span class="keywordflow">if</span> (beamon)
      {
        <span class="keywordflow">if</span> (++coloroffset &gt;= 10)
        {
          coloroffset = 0;
        }
      }
    }

    <span class="comment">// Send a scope plot</span>
    sendPlotData(&amp;dcsServer, MAXPLAT * 3 + 10, dtime, (0.5 * (sin(dtime * 0.1))) + 0.5);

    <span class="comment">// Updates the current scenario time to the server</span>
    <span class="comment">// and subsequently to all connected clients.</span>
    dcsServer.<a class="code" href="classDCSServer.html#aeb3f8ca7fcb263eb371d523b38e367bd" title="DCSServer sendTime.">sendTime</a>(dtime);
    
    <span class="comment">// Responsible for both servicing new client connection</span>
    <span class="comment">// requests and removing expired objects.</span>
    dcsServer.<a class="code" href="classDCSServer.html#abecbcd34cef85931bab46fb023b2b15d" title="DCSServer idle.">idle</a>(dtime);

    cout &lt;&lt; <span class="stringliteral">&quot;Server time: &quot;</span> &lt;&lt; dtime &lt;&lt; endl;

    <span class="comment">// check for keyboard entry, more specifically the q key</span>
<span class="preprocessor">#ifdef WIN32</span>
<span class="preprocessor"></span>    <span class="comment">// NOTE:  This does not work in rxvt, use bash</span>
    <span class="keywordflow">if</span> (_kbhit())
    {
      <span class="keywordtype">char</span> keyPressed = _getch();
      cout &lt;&lt; <span class="stringliteral">&quot;keyPressed: &quot;</span> &lt;&lt; keyPressed &lt;&lt; endl;
      <span class="keywordflow">if</span> (keyPressed == <span class="charliteral">&#39;q&#39;</span> || keyPressed == <span class="charliteral">&#39;Q&#39;</span>)
      {
        running=<span class="keyword">false</span>;
      }
      <span class="keywordflow">if</span> (keyPressed == <span class="charliteral">&#39;c&#39;</span> || keyPressed == <span class="charliteral">&#39;C&#39;</span>)
      {
        cout &lt;&lt; <span class="stringliteral">&quot;Clearing and rebuilding the database&quot;</span> &lt;&lt; endl;
        <span class="keywordtype">bool</span> cleaned = dcsServer.<a class="code" href="classDCSServer.html#ad8008c95b126fdb533df4535dad228c6" title="DCSServer cleanDatabaseFile.">cleanDatabaseFile</a>();
        cout &lt;&lt; <span class="stringliteral">&quot;Operation successful: &quot;</span> &lt;&lt; cleaned &lt;&lt; endl;
      }
      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (deletedPlatform == <span class="keyword">false</span> &amp;&amp; deletedBeam == <span class="keyword">false</span> &amp;&amp; deletedGate == <span class="keyword">false</span> )
      {
        <span class="keywordflow">if</span> (keyPressed == <span class="charliteral">&#39;p&#39;</span> || keyPressed == <span class="charliteral">&#39;P&#39;</span>)
        {
          cout &lt;&lt; <span class="stringliteral">&quot;Removing Platform 1&quot;</span> &lt;&lt; endl;
          dcsServer.<a class="code" href="classDCSServer.html#a079125928a444cff7e946d96dc538f09" title="DCSServer sendExpireEvent.">sendExpireEvent</a>(1, dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1, dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1+MAXPLAT, dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1+(MAXPLAT*2), dtime);
          deletedPlatform = <span class="keyword">true</span>;
          <span class="comment">// wait 10 seconds before platform is revived.</span>
          deletedTime = dtime + 10;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyPressed == <span class="charliteral">&#39;b&#39;</span> || keyPressed == <span class="charliteral">&#39;B&#39;</span>)
        {
          cout &lt;&lt; <span class="stringliteral">&quot;Removing Beam 11&quot;</span> &lt;&lt; endl;
          dcsServer.<a class="code" href="classDCSServer.html#a079125928a444cff7e946d96dc538f09" title="DCSServer sendExpireEvent.">sendExpireEvent</a>(1+MAXPLAT, dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1+MAXPLAT, dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1+(MAXPLAT*2), dtime);
          deletedBeam = <span class="keyword">true</span>;
          <span class="comment">// wait 10 seconds before beam is revived.</span>
          deletedTime = dtime + 10;
        }
        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (keyPressed == <span class="charliteral">&#39;g&#39;</span> || keyPressed == <span class="charliteral">&#39;G&#39;</span>)
        {
          cout &lt;&lt; <span class="stringliteral">&quot;Removing Gate 21&quot;</span> &lt;&lt; endl;
          dcsServer.<a class="code" href="classDCSServer.html#a079125928a444cff7e946d96dc538f09" title="DCSServer sendExpireEvent.">sendExpireEvent</a>(1+(MAXPLAT*2), dtime);
          dcsServer.<a class="code" href="classDCSServer.html#a4ff9d4d43f4efeb8b7c1d182dbaa5aba" title="DCSServer removeHeader.">removeHeader</a>(1+(MAXPLAT*2), dtime);
          deletedGate = <span class="keyword">true</span>;
          <span class="comment">// wait 10 seconds before gate is revived.</span>
          deletedTime = dtime + 10;
        }
      }
    }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="comment">// provide ~2 Hz data rate</span>
    Sleep(500);
    
  } <span class="comment">// end of while (running)</span>

  <span class="keywordflow">return</span> 0;
}
</pre></div> </div></div><!-- contents -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <title></title>
   
</head>
  <body>
           
<hr>    <br>
      2002-2008 U.S. Naval Research Laboratory. &nbsp;The 
U.S. Government retains   all rights  to use, duplicate, distribute, disclose,
 or release this document.   &nbsp;<br>
         <br>
         For further information regarding DCS or SIMDIS please visit <a
 href="https://simdis.nrl.navy.mil">https://simdis.nrl.navy.mil</a> or send e-mail to <a
 href="mailto:simdis@enews.nrl.navy.mil">simdis@enews.nrl.navy.mil</a>. &nbsp;<br>
         <br>
         Copies of DCS and SIMDIS, as well as this manual and other related 
 information,&nbsp;    may be obtained from <a
 href="https://simdis.nrl.navy.mil">https://simdis.nrl.navy.mil</a>.    &nbsp;<br>
         <br>
                 
<hr width="100%" size="2">   
<address><small>Generated at Mon Mar 26 2012 08:06:29 for the DCS API by <a
 href="http://www.stack.nl/%7Edimitri/doxygen/index.html">doxygen</a> 1.7.6.1.</small></address>
 <br>
 <br>
 <br>
 
</body>
</html>
